const ResponseCode={Success:0,InternalServerError:1,ForbiddenDomain:2,TakenID:3,InvalidURL:4};$(document).ready(function(){var customURLVisible=false;$("#custom-url-button").click(function(){if(customURLVisible){$("#custom-url").hide();$("#custom-url-button .up").hide();$("#custom-url-button .down").show()}else{$("#custom-url").show();$("#custom-url-button .up").show();$("#custom-url-button .down").hide()}customURLVisible=!customURLVisible});$("#footer").click(function(){$("#download")[0].scrollIntoView()});$("#shorten-button").click(function(){var url=$("#url").val();var id=$("#custom-url").val();var lower=url.toLowerCase();if(lower.includes(window.location.hostname)){M.toast({html:"Copied "+url+" to clipboard."});document.getElementById("url").select();document.execCommand("copy");return}if(url.length>2048){M.toast({html:"URL is too long, maximum size is 2048."});return}if(id.length>8){M.toast({html:"Custom URL is too long, maximum size is 8."});return}var Code=-1;$.ajax({url:"/new/",type:"POST",async:false,contentType:"application/json; charset=utf-8",data:JSON.stringify(customURLVisible?{url:url,id:id}:{url:url}),dataType:"json",success:function(r){Code=r.code;switch(r.code){case ResponseCode.Success:$("#url").val(window.location.protocol+"//"+window.location.hostname+"/"+r.id);break;case ResponseCode.InternalServerError:M.toast({html:"Internal server error: "+r.error});break;case ResponseCode.ForbiddenDomain:M.toast({html:"You can not shorten "+window.location.hostname+" links."});break;case ResponseCode.TakenID:M.toast({html:"That custom link has already been taken."});break;case ResponseCode.InvalidURL:M.toast({html:"That is not a valid URL."});break}}});if(Code===0){document.getElementById("url").select();document.execCommand("copy");M.toast({html:"Copied "+$("#url").val()+" to clipboard."})}})});
